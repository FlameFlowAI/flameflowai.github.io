<script type="text/javascript" charset="utf-8" src="/live2d-widget/autoload.js"></script><!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"><title>Building Android code search server based on opengrok | Know Yourself</title><meta name="description" content="Building Android code search server based on opengrok"><meta name="keywords" content="OpenGrok"><meta name="author" content="John White"><meta name="copyright" content="John White"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="twitter:card" content="summary"><meta name="twitter:title" content="Building Android code search server based on opengrok"><meta name="twitter:description" content="Building Android code search server based on opengrok"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/johnwhite-leaf/CDN/opengrok-logo.png"><meta property="og:type" content="article"><meta property="og:title" content="Building Android code search server based on opengrok"><meta property="og:url" content="https://johnwhite-leaf.github.io/articles/ebce7f08/"><meta property="og:site_name" content="Know Yourself"><meta property="og:description" content="Building Android code search server based on opengrok"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/johnwhite-leaf/CDN/opengrok-logo.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>const autoChangeMode = 'false'
var t = Cookies.get("theme");
if (autoChangeMode == '1'){
const isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
const isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
const isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

if (t === undefined){
  if (isLightMode) activateLightMode()
  else if (isDarkMode) activateDarkMode()
  else if (isNotSpecified || hasNoSupport){
    console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
    now = new Date();
    hour = now.getHours();
    isNight = hour < 6 || hour >= 18
    isNight ? activateDarkMode() : activateLightMode()
}
} else if (t == 'light') activateLightMode()
else activateDarkMode()


} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><link rel="canonical" href="https://johnwhite-leaf.github.io/articles/ebce7f08/"><link rel="prev" title="How to write resume?" href="https://johnwhite-leaf.github.io/articles/42747d96/"><link rel="next" title="Wtite something" href="https://johnwhite-leaf.github.io/articles/1eafa253/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简"},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  bookmark: {
    title: 'Snackbar.bookmark.title',
    message_prev: 'Press',
    message_next: 'to bookmark this page'
  },
  runtime_unit: 'days',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: {"bookmark":{"title":"Snackbar.bookmark.title","message_prev":"Press","message_next":"to bookmark this page"},"chs_to_cht":"Traditional Chinese Activated Manually","cht_to_chs":"Simplified Chinese Activated Manually","day_to_night":"Light Mode Activated Manually","night_to_day":"Dark Mode Activated Manually","bgLight":"#49b1f5","bgDark":"#2d3035","position":"bottom-center"},
  baiduPush: false,
  isHome: false,
  isPost: true
  
}</script><meta name="generator" content="Hexo 4.2.0"></head><body><canvas class="fireworks"></canvas><header> <div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/">Know Yourself</a></span><span class="toggle-menu pull_right close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-coffee"></i><span> Messageboard</span></a></div><div class="menus_item"><a class="site-page" href="/galleries/"><i class="fa-fw fa fa-picture-o"></i><span> Galleries</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item" mobile-hidden="true"><a class="site-page" href="/coolresume/"><i class="fa-fw fa fa-address-card"></i><span> Cool Resume</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-globe" aria-hidden="true"></i><span> English</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/"><span> English</span></a></li><li><a class="site-page" href="/cn/"><span> 简体中文</span></a></li></ul></div></div></span></div></header><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/author.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">Articles</div><div class="length_num">11</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">Tags</div><div class="length_num">8</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">Categories</div><div class="length_num">4</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/messageboard/"><i class="fa-fw fa fa-coffee"></i><span> Messageboard</span></a></div><div class="menus_item"><a class="site-page" href="/galleries/"><i class="fa-fw fa fa-picture-o"></i><span> Galleries</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item" mobile-hidden="true"><a class="site-page" href="/coolresume/"><i class="fa-fw fa fa-address-card"></i><span> Cool Resume</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-globe" aria-hidden="true"></i><span> English</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/"><span> English</span></a></li><li><a class="site-page" href="/cn/"><span> 简体中文</span></a></li></ul></div></div></div><div id="mobile-sidebar-toc"><div class="toc_mobile_headline">Catalog</div><div class="sidebar-toc__content"><ol class="toc_mobile_items"><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#table-of-Contents"><span class="toc_mobile_items-number">1.</span> <span class="toc_mobile_items-text">table of Contents</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#1-Introduction-to-OpenGrok"><span class="toc_mobile_items-number">2.</span> <span class="toc_mobile_items-text">1. Introduction to OpenGrok</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-3"><a class="toc_mobile_items-link" href="#2-Install-OpenGrok"><span class="toc_mobile_items-number">3.</span> <span class="toc_mobile_items-text">2. Install OpenGrok</span></a><ol class="toc_mobile_items-child"><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-1-Install-JAVA-Runtime-Environment"><span class="toc_mobile_items-number">3.1.</span> <span class="toc_mobile_items-text">2.1 Install JAVA Runtime Environment</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-2-Install-Web-Server-Tomcat"><span class="toc_mobile_items-number">3.2.</span> <span class="toc_mobile_items-text">2.2 Install Web Server-Tomcat</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-3-Install-OpenGrok"><span class="toc_mobile_items-number">3.3.</span> <span class="toc_mobile_items-text">2.3 Install OpenGrok</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-4-Configure-OpenGrok"><span class="toc_mobile_items-number">3.4.</span> <span class="toc_mobile_items-text">2.4 Configure OpenGrok</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-5-Install-universal-ctags"><span class="toc_mobile_items-number">3.5.</span> <span class="toc_mobile_items-text">2.5 Install universal-ctags</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-6-Build-Source-Index"><span class="toc_mobile_items-number">3.6.</span> <span class="toc_mobile_items-text">2.6 Build Source Index</span></a></li><li class="toc_mobile_items-item toc_mobile_items-level-4"><a class="toc_mobile_items-link" href="#2-6-Update-source-index"><span class="toc_mobile_items-number">3.7.</span> <span class="toc_mobile_items-text">2.6 Update source index</span></a></li></ol></li></ol></div></div></div><div id="body-wrap"><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true">     </i><div class="auto_open" id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#table-of-Contents"><span class="toc-number">1.</span> <span class="toc-text">table of Contents</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-Introduction-to-OpenGrok"><span class="toc-number">2.</span> <span class="toc-text">1. Introduction to OpenGrok</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Install-OpenGrok"><span class="toc-number">3.</span> <span class="toc-text">2. Install OpenGrok</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-Install-JAVA-Runtime-Environment"><span class="toc-number">3.1.</span> <span class="toc-text">2.1 Install JAVA Runtime Environment</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-Install-Web-Server-Tomcat"><span class="toc-number">3.2.</span> <span class="toc-text">2.2 Install Web Server-Tomcat</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-Install-OpenGrok"><span class="toc-number">3.3.</span> <span class="toc-text">2.3 Install OpenGrok</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-Configure-OpenGrok"><span class="toc-number">3.4.</span> <span class="toc-text">2.4 Configure OpenGrok</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-5-Install-universal-ctags"><span class="toc-number">3.5.</span> <span class="toc-text">2.5 Install universal-ctags</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-6-Build-Source-Index"><span class="toc-number">3.6.</span> <span class="toc-text">2.6 Build Source Index</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-6-Update-source-index"><span class="toc-number">3.7.</span> <span class="toc-text">2.6 Update source index</span></a></li></ol></li></ol></div></div></div><main id="content-outer"><div id="top-container" style="background-image: url(https://cdn.jsdelivr.net/gh/johnwhite-leaf/CDN/opengrok-logo.png)"><div id="post-info"><div id="post-title"><div class="posttitle">Building Android code search server based on opengrok</div></div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> Created 2019-05-05<span class="post-meta__separator">|</span><i class="fa fa-history fa-fw" aria-hidden="true"></i> Updated 2020-03-17</time><div class="post-meta-wordcount"><i class="fa fa-file-word-o post-meta__icon fa-fw" aria-hidden="true"></i><span>Word count:</span><span class="word-count">1.4k</span><span class="post-meta__separator">|</span><i class="fa fa-clock-o post-meta__icon fa-fw" aria-hidden="true"></i><span>Reading time: 8 min</span><div class="post-meta-pv-cv"><span class="post-meta__separator">|</span><span><i class="fa fa-eye post-meta__icon fa-fw" aria-hidden="true"> </i>Post View:</span><span id="busuanzi_value_page_pv"></span></div></div></div></div></div><div class="layout layout_post" id="content-inner">   <article id="post"><div class="article-container" id="post-content"><h3 id="table-of-Contents"><a href="#table-of-Contents" class="headerlink" title="table of Contents"></a>table of Contents</h3><ol>
<li><p>Introduction to OpenGrok</p>
</li>
<li><p>Install OpenGrok</p>
<p> 2.1 Install JAVA runtime environment</p>
<p> 2.2 Install Web Server-Tomcat</p>
<p> 2.3 Install OpenGrok</p>
<p> 2.4 Configure OpenGrok</p>
<p> 2.5 Install universal-ctags</p>
<p> 2.6 Build Source Index</p>
<p> 2.6 Update source index</p>
</li>
</ol>
<h3 id="1-Introduction-to-OpenGrok"><a href="#1-Introduction-to-OpenGrok" class="headerlink" title="1. Introduction to OpenGrok"></a>1. Introduction to OpenGrok</h3><p>OpenGrok is a fast and usable source code search and cross reference engine. It helps you search, cross-reference and navigate your source tree</p>
<p>Requirements:</p>
<ul>
<li>Latest Java 1.8</li>
<li>A servlet container like GlassFish or Tomcat (8.x or later) also running with Java at least 1.8</li>
<li>Universal ctags (Exuberant ctags work too)</li>
</ul>
<p>OpenGrok is a fast and easy-to-use source search engine and comparison engine.It can help us quickly search, locate and compare code trees.</p>
<p>system requirement:</p>
<ul>
<li>Java 1.8</li>
<li>Web server GlassFish or Tomcat (8.x or later, here Tomcat8)</li>
<li>Universal ctags (Exuberant ctags also work, there are pits here, in fact Exuberant ctags do not work, the latest version of OpenGrok will detect whether there are Universal ctags when indexing, and no direct error is reported)</li>
</ul>
<p>In short, OpenGrok is a millisecond-level code search tool, and its biggest advantage is that the search speed is fast.</p>
<h3 id="2-Install-OpenGrok"><a href="#2-Install-OpenGrok" class="headerlink" title="2. Install OpenGrok"></a>2. Install OpenGrok</h3><h4 id="2-1-Install-JAVA-Runtime-Environment"><a href="#2-1-Install-JAVA-Runtime-Environment" class="headerlink" title="2.1 Install JAVA Runtime Environment"></a>2.1 Install JAVA Runtime Environment</h4><p>OpenGrok and Tomcat both rely on JAVA, so we first need a JDK to support its operation</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get install openjdk-8-jdk</span><br><span class="line">java -version &#x2F;&#x2F; Check if java is installed correctly</span><br></pre></td></tr></table></figure></div>

<p>For specific installation, please refer to the detailed installation of Ubuntu JDK</p>
<h4 id="2-2-Install-Web-Server-Tomcat"><a href="#2-2-Install-Web-Server-Tomcat" class="headerlink" title="2.2 Install Web Server-Tomcat"></a>2.2 Install Web Server-Tomcat</h4><p>OpenGrok is web-based access and requires a web system to support it, so a web server must be installed.</p>
<p>The Tomcat8 package is already provided in the source of Ubuntu18.04, and Tomcat8 is installed directly from the source.</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install tomcat8</span><br><span class="line">Start Tomcat8</span><br><span class="line"></span><br><span class="line">sudo service tomcat8 start &#x2F;&#x2F; Start the Tomcat service</span><br><span class="line">or</span><br><span class="line"></span><br><span class="line">sudo &#x2F;etc&#x2F;init.d&#x2F;tomcat8 start</span><br><span class="line">After starting the Tomcat service, enter the URL in the browser and see that the page displays &quot;It works!&quot;</span><br></pre></td></tr></table></figure></div>
<p><a href="http://localhost" target="_blank" rel="noopener">http://localhost</a>: 8080</p>
<p>Tomcat8 common commands</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sudo service tomcat8 start &#x2F;&#x2F; Start the Tomcat service</span><br><span class="line">sudo service tomcat8 stop &#x2F;&#x2F; Close the Tomcat service</span><br><span class="line">sudo service tomcat8 status &#x2F;&#x2F; View Tomcat service status</span><br><span class="line">sudo service tomcat8 restart &#x2F;&#x2F; Restart the Tomcat service</span><br></pre></td></tr></table></figure></div>
<p>For more detailed installation, please refer to Ubuntu installation and configuration tomcat8 service</p>
<h4 id="2-3-Install-OpenGrok"><a href="#2-3-Install-OpenGrok" class="headerlink" title="2.3 Install OpenGrok"></a>2.3 Install OpenGrok</h4><p>After installing Tomcat, the next step is to configure OpenGrok.</p>
<p>OpenGrok Download Address:</p>
<p><a href="http://opengrok.github.io/OpenGrok" target="_blank" rel="noopener">http://opengrok.github.io/OpenGrok</a></p>
<p><a href="https://github.com/oracle/opengrok/releases" target="_blank" rel="noopener">https://github.com/oracle/opengrok/releases</a></p>
<p>You can download the compiled file of OpenGrok, or you can download the source file at this URL. Here we directly download the compiled file (the students who are interested in OpenGrok can download the source code to see what it is). After downloading, decompress it with the following command:</p>
<p>tar xvzf opengrok-1.1-rc41.tar.gz -C/opt</p>
<h4 id="2-4-Configure-OpenGrok"><a href="#2-4-Configure-OpenGrok" class="headerlink" title="2.4 Configure OpenGrok"></a>2.4 Configure OpenGrok</h4><p>If you want OpenGrok to run properly, you need a lot of environment variables. If we install jdk, Tomcat and OpenGrok according to the requirements of OpenGrok, and establish a directory structure, these environment variables will be set correctly when running the OpenGrok script, but if we If you want more flexible configuration, you still have to customize the directory structure, and manually configure these environment variables.</p>
<p>The environment variables are configured as follows: opengrokSetEnv.sh</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"># ------------------------------------------------- ------------------------------</span><br><span class="line">#-JAVA_HOME Full Path to Java Installation Root</span><br><span class="line">#-JAVA Full Path to java binary (to enable 64bit JDK)</span><br><span class="line">#-JAVA_OPTS Java options (e.g. for JVM memory increase</span><br><span class="line"># ------------------------------------------------- ------------------------------</span><br><span class="line">JAVA_HOME &#x3D;&#x2F;usr&#x2F;lib&#x2F;jvm&#x2F;java-8-openjdk-amd64</span><br><span class="line">JRE_HOME &#x3D; $ JAVA_HOME&#x2F;jre</span><br><span class="line">JAVA_BIN &#x3D; $ JAVA_HOME&#x2F;bin</span><br><span class="line">CLASSPATH &#x3D; $ JAVA_HOME&#x2F;lib&#x2F;dt.jar: $ JAVA_HOME&#x2F;lib&#x2F;tools.jar: $ JRE_HOME&#x2F;lib</span><br><span class="line">PATH &#x3D; $ PATH: $ JAVA_HOME&#x2F;bin: $ JRE_HOME&#x2F;bin</span><br><span class="line">export JAVA_HOME JRE_HOME PATH CLASSPATH</span><br><span class="line"></span><br><span class="line"># ------------------------------------------------- ------------------------------</span><br><span class="line">#-OPENGROK_DISTRIBUTION_BASE Base Directory of the OpenGrok Distribution</span><br><span class="line">#-OPENGROK_INSTANCE_BASE Base Directory of the OpenGrok User Data Area</span><br><span class="line">#-EXUBERANT_CTAGS Full Path to Exuberant CTags</span><br><span class="line">#-OPENGROK_CTAGS_OPTIONS_FILE Full path to file with extra command line</span><br><span class="line"># options for CTags program (for its --options</span><br><span class="line"># ------------------------------------------------- ------------------------------</span><br><span class="line"># opengrok home directory</span><br><span class="line">export OPENGROK_INSTANCE_BASE &#x3D;&#x2F;opt&#x2F;opengrok</span><br><span class="line">export SCRIPT_DIRECTORY &#x3D; $ OPENGROK_INSTANCE_BASE&#x2F;bin</span><br><span class="line">export OPENGROK_DISTRIBUTION_BASE &#x3D; $ OPENGROK_INSTANCE_BASE&#x2F;lib</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># source code root</span><br><span class="line">export SRC_ROOT &#x3D; $ OPENGROK_INSTANCE_BASE&#x2F;database&#x2F;src</span><br><span class="line"># generated data root</span><br><span class="line">export DATA_ROOT &#x3D; $ OPENGROK_INSTANCE_BASE&#x2F;database&#x2F;data</span><br><span class="line">#</span><br><span class="line">EXUB_CTAGS &#x3D;&#x2F;usr&#x2F;bin&#x2F;ctags</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"># ------------------------------------------------- ------------------------------</span><br><span class="line">#-OPENGROK_APP_SERVER Application Server (&quot;Tomcat&quot; or &quot;Glassfish&quot;)</span><br><span class="line">#-OPENGROK_WAR_TARGET_TOMCAT Tomcat Specific WAR Target Directory</span><br><span class="line">#-OPENGROK_WAR_TARGET_GLASSFISH Glassfish Specific WAR Target Directory</span><br><span class="line">#-OPENGROK_WAR_TARGET Fallback WAR Target Directory</span><br><span class="line">#-OPENGROK_TOMCAT_BASE Base Directory for Tomcat (contains webapps)</span><br><span class="line">#-OPENGROK_GLASSFISH_BASE Base Directory for Glassfish</span><br><span class="line"># (contains domains)</span><br><span class="line"># ------------------------------------------------- ------------------------------</span><br><span class="line">export OPENGROK_APP_SERVER &#x3D; Tomcat</span><br><span class="line">export OPENGROK_TOMCAT_BASE &#x3D;&#x2F;var&#x2F;lib&#x2F;tomcat8</span><br><span class="line">export OPENGROK_WAR_TARGET_TOMCAT &#x3D; $ OPENGROK_TOMCAT_BASE&#x2F;webapps</span><br><span class="line">export OPENGROK_WAR_TARGET &#x3D; $ OPENGROK_TOMCAT_BASE&#x2F;webapps</span><br><span class="line">export CATALINA_HOME &#x3D; $ OPENGROK_TOMCAT_BASE</span><br></pre></td></tr></table></figure></div>
<p>Once completed, you can use the opengrokSetEnv.sh script to set environment variables every time before running OpenGrok</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source opengrokSetEnv.sh</span><br></pre></td></tr></table></figure></div>
<p>For information on OpenGrok scripts, see <a href="https://github.com/OpenGrok/OpenGrok/blob/master/OpenGrok" target="_blank" rel="noopener">https://github.com/OpenGrok/OpenGrok/blob/master/OpenGrok</a></p>
<p>If the error occurs, please check the source code to set the environment variable information.</p>
<p>After decompression, go to the decompression directory, and copy the source.war package in the/opt/opengrok/lib directory to the apache-tomcat/webapps directory</p>
<p>Enter in browser</p>
<p><a href="http://localhost:8080/source/" target="_blank" rel="noopener">http://localhost:8080/source/</a></p>
<p>If you see the OpenGrok page, it proves that OpenGrok is running successfully.</p>
<p>Next you need to change the web.xml configuration file in the apache-tomcat/webapps/source/WEB-INF directory</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;context-param&gt;</span><br><span class="line">   &lt;param-name&gt; CONFIGURATION &lt;&#x2F; param-name&gt;</span><br><span class="line">   &lt;param-value&gt; &#x2F;opt&#x2F;opengrok&#x2F;etc&#x2F;configuration.xml &lt;&#x2F; param-value&gt;</span><br><span class="line">   &lt;description&gt; Full path to the configuration file where OpenGrok can read it&#39;s configuration &lt;&#x2F; description&gt;</span><br><span class="line"> &lt;&#x2F; context-param&gt;</span><br></pre></td></tr></table></figure></div>
<p>Configure the path of configuration.xml to the/opt/opengrok/etc/configuration directory.This configuration.xm will be automatically generated in the following source code indexing steps.</p>
<h4 id="2-5-Install-universal-ctags"><a href="#2-5-Install-universal-ctags" class="headerlink" title="2.5 Install universal-ctags"></a>2.5 Install universal-ctags</h4><div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install autoconf</span><br><span class="line">cd&#x2F;tmp</span><br><span class="line">git clone https:&#x2F;&#x2F;github.com&#x2F;universal-ctags&#x2F;ctags</span><br><span class="line">cd ctags</span><br><span class="line">.&#x2F;autogen.sh</span><br><span class="line">.&#x2F;configure --prefix &#x3D;&#x2F;opt&#x2F;universal-ctags # My installation path. You adjust to your situation.</span><br><span class="line">make -j8</span><br><span class="line">sudo make install</span><br><span class="line">Update the ctags executable to the system PATH? No, I choose how to create the link:</span><br><span class="line"></span><br><span class="line"># If you have Exuberant ctags installed, first delete the linked files:</span><br><span class="line"># sudo mv &#x2F;usr&#x2F;bin&#x2F;ctags &#x2F;usr&#x2F;bin&#x2F;ctags.bak</span><br><span class="line"></span><br><span class="line"># Then, link over the newly compiled and installed universal-ctags:</span><br><span class="line">sudo ln -s &#x2F;opt&#x2F;universal-ctags&#x2F;bin&#x2F;ctags&#x2F;usr&#x2F;bin&#x2F;ctags</span><br></pre></td></tr></table></figure></div>

<h4 id="2-6-Build-Source-Index"><a href="#2-6-Build-Source-Index" class="headerlink" title="2.6 Build Source Index"></a>2.6 Build Source Index</h4><p>Next, we need to configure the index for our source code. OpenGrok generates the index information of the source code. It looks like it is to establish a relevant database to achieve the purpose of fast search.</p>
<p>Set the following environment variables</p>
<p>Environment variable Description Default value<br>SRC_ROOT The source code path of the index to be generated $ {OPENGROK_INSTANCE_BASE}/src<br>DATA_ROOT Path to the generated index $ {OPENGROK_INSTANCE_BASE}/data<br>Then we can directly create the src and data directories in the opengrok installation directory/opt/opengrok</p>
<p>Then we put the source code that needs to be indexed in the src directory. Of course, we don’t really need to put the source code here, we just need to create a link for it.</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;opt&#x2F;opengrok&#x2F;src</span><br><span class="line">ln -s &#x2F;usr&#x2F;src&#x2F;android8.0 android8.0</span><br></pre></td></tr></table></figure></div>
<p>Generate index</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">indexer.py -J &#x3D; -Djava.util.logging.config.file &#x3D;&#x2F;opt&#x2F;opengrok&#x2F;logging.properties \</span><br><span class="line">    -a &#x2F;opt&#x2F;opengrok&#x2F;lib&#x2F;opengrok.jar-\</span><br><span class="line">    -s&#x2F;opt&#x2F;opengrok&#x2F;src -d&#x2F;opt&#x2F;opengrok&#x2F;data -H -P -S -G \</span><br><span class="line">    -W &#x2F;opt&#x2F;opengrok&#x2F;etc&#x2F;configuration.xml -U http: &#x2F;&#x2F; localhost: 8080</span><br></pre></td></tr></table></figure></div>

<p>Then we open</p>
<p><a href="http://localhost:8080/source" target="_blank" rel="noopener">http://localhost:8080/source</a></p>
<p>You can see our source code</p>
<h4 id="2-6-Update-source-index"><a href="#2-6-Update-source-index" class="headerlink" title="2.6 Update source index"></a>2.6 Update source index</h4><p>When the code changes, the source code index needs to be updated to reflect the changes to Opengrok</p>
<div class="code-area-wrap"><div class="highlight-tools"><i class="fa fa-angle-down code-expand" aria-hidden="true"></i><div class="code_lang">Code</div><div class="copy-notice"></div><i class="fa fa-clipboard" aria-hidden="true"></i></div><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">touch&#x2F;opt&#x2F;opengrok&#x2F;src&#x2F;*</span><br><span class="line"></span><br><span class="line">cd&#x2F;opt&#x2F;opengrok&#x2F;bin</span><br><span class="line"></span><br><span class="line">indexer.py -J &#x3D; -Djava.util.logging.config.file &#x3D;&#x2F;opt&#x2F;opengrok&#x2F;logging.properties \</span><br><span class="line">    -a &#x2F;opt&#x2F;opengrok&#x2F;lib&#x2F;opengrok.jar-\</span><br><span class="line">    -s&#x2F;opt&#x2F;opengrok&#x2F;src -d&#x2F;opt&#x2F;opengrok&#x2F;data -H -P -S -G \</span><br><span class="line">    -W &#x2F;opt&#x2F;opengrok&#x2F;etc&#x2F;configuration.xml -U http: &#x2F;&#x2F; localhost: 8080</span><br></pre></td></tr></table></figure></div></div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">John White</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://johnwhite-leaf.github.io/articles/ebce7f08/">https://johnwhite-leaf.github.io/articles/ebce7f08/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/OpenGrok/">OpenGrok    </a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/johnwhite-leaf/CDN/opengrok-logo.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><div class="post-reward"><a class="reward-button button--primary button--animated"> <i class="fa fa-qrcode"></i> Donate<div class="reward-main"><ul class="reward-all"><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/wechat.jpg" alt="微信"><div class="post-qr-code__desc">微信</div></li><li class="reward-item"><img class="lazyload post-qr-code__img" src="/img/alipay.jpg" alt="支付宝"><div class="post-qr-code__desc">支付宝</div></li></ul></div></a></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/articles/42747d96/"><img class="prev_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/johnwhite-leaf/CDN/resume-logo.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">Previous Post</div><div class="prev_info"><span>How to write resume?</span></div></a></div><div class="next-post pull_right"><a href="/articles/1eafa253/"><img class="next_cover lazyload" data-src="https://cdn.jsdelivr.net/gh/johnwhite-leaf/CDN/mr-write-logo.png" onerror="onerror=null;src='/img/404.jpg'"><div class="label">Next Post</div><div class="next_info"><span>Wtite something</span></div></a></div></nav><hr><div id="post-comment"><div class="comment_headling"><i class="fa fa-comments fa-fw" aria-hidden="true"></i><span> Comment</span></div><div class="vcomment" id="vcomment"></div><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var notify = false == true ? true : false;
var verify = false == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;

window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'SQRBzXUT1TEvasyltUXgHWsn-gzGzoHsz',
  appKey:'EOzGyrBHy4fhVTvG1hFatTon',
  placeholder:'Please leave your footprints',
  avatar:'monsterid',
  guest_info:guest_info,
  pageSize:'10',
  lang:'en',
  recordIP: true
});</script></div></div></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By John White</div><div class="framework-info"><span>Driven </span><a href="http://hexo.io" target="_blank" rel="noopener"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme </span><a href="https://github.com/jerryc127/hexo-theme-butterfly" target="_blank" rel="noopener"><span>Butterfly</span></a></div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="Read Mode"></i><i class="fa fa-plus" id="font_plus" title="Increase font size"></i><i class="fa fa-minus" id="font_minus" title="Decrease font size"></i><i class="darkmode fa fa-moon-o" id="darkmode" title="Dark Mode"></i></div><div id="rightside-config-show"><div id="rightside_config" title="Setting"><i class="fa fa-cog" aria-hidden="true"></i></div><a id="to_comment" href="#post-comment" title="Scroll to comment"><i class="scroll_to_comment fa fa-comments">  </i></a><i class="fa fa-list-ul close" id="mobile-toc-button" title="Table of Contents" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="Back to top" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/js/fireworks.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script id="ribbon" src="https://cdn.jsdelivr.net/gh/jerryc127/butterfly_cdn@2.1.0/js/canvas-ribbon.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="false"></script><script src="https://cdn.jsdelivr.net/npm/activate-power-mode/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true; 
document.body.addEventListener('input', POWERMODE);
</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/lazysizes@latest/lazysizes.min.js" async=""></script></body></html>